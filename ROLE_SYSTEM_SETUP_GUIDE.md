# üîê –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –∏ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Ä–æ–ª—è–º–∏ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º.

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### **–ú–æ–¥–µ–ª–∏:**
- **Role** - —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (admin, moderator, editor, user)
- **Permission** - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
- **User** - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ä–æ–ª–µ–π

### **–°–≤—è–∑–∏:**
- **User ‚Üî Role** (Many-to-Many —á–µ—Ä–µ–∑ `user_roles`)
- **Role ‚Üî Permission** (Many-to-Many —á–µ—Ä–µ–∑ `role_permissions`)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### **1. –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π**
```bash
php artisan migrate
```

### **2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–ª–µ–π –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π**
```bash
php artisan db:seed --class=RolePermissionSeeder
```

### **3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
```bash
php artisan admin:create-user
```

–ò–ª–∏ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```bash
php artisan admin:create-user --email=admin@example.com --name="Super Admin" --password=password123
```

## üë• –†–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### **–†–æ–ª–∏:**

#### **üî¥ Super Admin (super_admin)**
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º —Å–∏—Å—Ç–µ–º—ã
- –í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

#### **üü† Admin (admin)**
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–Ω–∏–≥–∞–º–∏, –∞–≤—Ç–æ—Ä–∞–º–∏
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### **üü° Moderator (moderator)**
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–Ω–∑–∏–π –∏ —Ñ–æ—Ä—É–º–∞
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

#### **üü¢ Editor (editor)**
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–∏–≥, –∞–≤—Ç–æ—Ä–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ—Ü–µ–Ω–∑–∏–π

#### **üîµ User (user)**
- –û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∞–≤–∞

### **–ì—Ä—É–ø–ø—ã —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**

- **admin** - –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- **users** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **books** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∞–º–∏
- **authors** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞–º–∏
- **categories** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
- **reviews** - –º–æ–¥–µ—Ä–∞—Ü–∏—è —Ä–µ—Ü–µ–Ω–∑–∏–π
- **forum** - –º–æ–¥–µ—Ä–∞—Ü–∏—è —Ñ–æ—Ä—É–º–∞
- **roles** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
- **settings** - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

## üõ°Ô∏è Middleware

### **–î–æ—Å—Ç—É–ø–Ω—ã–µ middleware:**

#### **admin**
```php
Route::middleware(['admin'])->group(function () {
    // –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
});
```

#### **role:admin**
```php
Route::middleware(['role:admin'])->group(function () {
    // –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é admin
});
```

#### **permission:users.edit**
```php
Route::middleware(['permission:users.edit'])->group(function () {
    // –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º users.edit
});
```

## üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π:**
```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏
if (auth()->user()->hasRole('admin')) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–æ–ª–µ–π
if (auth()->user()->hasAnyRole(['admin', 'moderator'])) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω –∏–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
if (auth()->user()->isAdmin()) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
}
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**
```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
if (auth()->user()->hasPermission('users.edit')) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
if (auth()->user()->hasAnyPermission(['books.create', 'books.edit'])) {
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–Ω–∏–≥–∏
}
```

### **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π:**
```php
// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–æ–ª–∏
$adminRole = Role::where('slug', 'admin')->first();

// –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
$user->assignRole($adminRole);

// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π
$user->syncRoles([1, 2, 3]); // ID —Ä–æ–ª–µ–π

// –£–¥–∞–ª–µ–Ω–∏–µ —Ä–æ–ª–∏
$user->removeRole($adminRole);
```

## üéõÔ∏è Filament –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

### **–î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏:**
- URL: `/admin11`
- –î–æ—Å—Ç—É–ø: —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ä–æ–ª—å—é `admin` –∏–ª–∏ `super_admin`

### **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏:**
- **–†–æ–ª–∏** - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π
- **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** - –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

### **–ù–æ–≤—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- `RoleResource` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏
- `PermissionResource` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `UserResource` - —Å –ø–æ–ª–µ–º —Ä–æ–ª–µ–π

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
php artisan admin:create-user --email=test@example.com --name="Test Admin" --password=password
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –≤ tinker:**
```bash
php artisan tinker

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
$user = User::where('email', 'admin@example.com')->first();
$user->roles;
$user->hasRole('admin');
$user->isAdmin();

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
$user->permissions;
$user->hasPermission('users.edit');
```

## üö® –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —É–¥–∞–ª—è–π—Ç–µ —Ä–æ–ª—å `super_admin`** - —ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ
2. **–í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é** –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ä–æ–ª–µ–π
3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –†–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–µ—à–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `withCount()` –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
- –ì—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º –¥–ª—è –ª—É—á—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:**
1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**
   ```php
   Permission::create([
       'name' => '–ù–æ–≤–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ',
       'slug' => 'new.permission',
       'group' => 'new_group',
       'description' => '–û–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è'
   ]);
   ```

2. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ä–æ–ª–µ–π:**
   ```php
   $role = Role::create([
       'name' => '–ù–æ–≤–∞—è —Ä–æ–ª—å',
       'slug' => 'new_role',
       'description' => '–û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏'
   ]);
   
   $role->syncPermissions([1, 2, 3]); // ID —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
   ```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π:
- ‚úÖ –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- ‚úÖ –ì–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏
- ‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
php artisan admin:create-user

# –ó–∞–ø—É—Å–∫ —Å–∏–¥–µ—Ä–∞ —Ä–æ–ª–µ–π
php artisan db:seed --class=RolePermissionSeeder

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
php artisan cache:clear
php artisan config:clear

# –ü—Ä–æ—Å–º–æ—Ç—Ä –º–∞—Ä—à—Ä—É—Ç–æ–≤
php artisan route:list
```
