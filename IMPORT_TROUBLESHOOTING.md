# Устранение проблем с импортом Excel

## Проблема: "Файл не найден"

### Решение 1: Используйте отдельную страницу импорта
1. Перейдите в админ панель: `http://your-domain.com/admin11`
2. В меню найдите "Импорт книг"
3. Загрузите файл через форму на этой странице

### Решение 2: Проверьте формат файла
- Убедитесь, что файл имеет расширение `.xlsx` или `.xls`
- Скачайте шаблон и используйте его как основу

### Решение 3: Очистите временные файлы
```bash
php artisan app:clean-temp-files
```

## Альтернативные способы импорта

### 1. Через админ панель (раздел "Книги")
- Нажмите кнопку "Импорт из Excel"
- Загрузите файл в модальном окне
- Если не работает, используйте отдельную страницу

### 2. Через отдельную страницу импорта
- URL: `/admin11/import-books`
- Более надежный способ
- Подробные инструкции на странице

### 3. Через командную строку
```bash
php artisan tinker
```
```php
use Maatwebsite\Excel\Facades\Excel;
use App\Imports\BooksImport;

Excel::import(new BooksImport, 'path/to/your/file.xlsx');
```

## Проверка файла

### Обязательные поля
- `nazvanie` - название книги (обязательно)

### Рекомендуемые поля
- `kategoriya` - название категории (должна существовать)
- `avtor` - имя автора в формате "Имя Фамилия" (должен существовать)

### Формат файла
- Первая строка должна содержать заголовки
- Используйте русские названия колонок
- Сохраните в формате Excel (.xlsx или .xls)

## Отладка

### Проверьте логи
```bash
tail -f storage/logs/laravel.log
```

### Проверьте права доступа
```bash
chmod -R 755 storage/
chmod -R 755 public/storage/
```

### Проверьте настройки PHP
- `upload_max_filesize` - максимальный размер загружаемого файла
- `post_max_size` - максимальный размер POST данных
- `memory_limit` - лимит памяти

## Частые ошибки

### 1. "Файл не найден"
- Используйте отдельную страницу импорта
- Проверьте права доступа к папке storage

### 2. "Категория не найдена"
- Создайте категорию в админ панели
- Используйте точное название категории

### 3. "Автор не найден"
- Создайте автора в админ панели
- Используйте формат "Имя Фамилия"

### 4. "Ошибка валидации"
- Проверьте обязательные поля
- Убедитесь в правильности типов данных

## Поддержка

Если проблемы продолжаются:
1. Проверьте логи приложения
2. Убедитесь в правильности формата файла
3. Попробуйте импортировать по одной записи
4. Обратитесь к разработчику с описанием ошибки
